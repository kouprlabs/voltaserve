version: '3.8'

volumes:
  postgres:
    name: voltaserve-postgres
  minio:
    name: voltaserve-minio
  meilisearch:
    name: voltaserve-meilisearch
  redis:
    name: voltaserve-redis
  redisinsight:
    name: voltaserve-redisinsight

services:
  postgres:
    container_name: voltaserve-postgres
    image: postgres:15.1
    ports:
      - ${VOLTASERVE_POSTGRES_PORT}:5432
    environment:
      POSTGRES_USER: voltaserve
      POSTGRES_PASSWORD: voltaserve
    volumes:
      - postgres:/var/lib/postgresql/data
      - ./infra/postgres/schema.sql:/docker-entrypoint-initdb.d/schema.sql
  adminer:
    container_name: voltaserve-adminer
    image: adminer:4.8.1
    ports:
      - ${VOLTASERVE_ADMINER_PORT}:8080
  minio:
    container_name: voltaserve-minio
    image: minio/minio:RELEASE.2023-01-25T00-19-54Z
    ports:
      - ${VOLTASERVE_MINIO_PORT}:9000
      - ${VOLTASERVE_MINIO_CONSOLE_PORT}:9001
    environment:
      MINIO_ROOT_USER: voltaserve
      MINIO_ROOT_PASSWORD: voltaserve
      MINIO_REGION: us-east-1
    volumes:
      - minio:/data
    command: server /data --console-address ":${VOLTASERVE_MINIO_CONSOLE_PORT}"
  meilisearch:
    container_name: voltaserve-meilisearch
    image: getmeili/meilisearch:v0.30
    ports:
      - ${VOLTASERVE_MEILISEARCH_PORT}:7700
    volumes:
      - meilisearch:/meili_data
  redis:
    container_name: voltaserve-redis
    image: redis:7.0.8
    ports:
      - ${VOLTASERVE_REDIS_PORT}:6379
    volumes:
      - redis:/data
  redisinsight:
    container_name: voltaserve-redisinsight
    image: redislabs/redisinsight:1.13.1
    ports:
      - ${VOLTASERVE_REDISINSIGHT_PORT}:8001
    volumes:
      - redisinsight:/db  
  mailcatcher:
    container_name: voltaserve-mailcatcher
    image: sj26/mailcatcher:v0.8.2
    ports:
      - ${VOLTASERVE_MAILCATCHER_WEB_PORT}:1080
      - ${VOLTASERVE_MAILCATCHER_SMTP_PORT}:1025